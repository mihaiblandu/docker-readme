version: 2.1
jobs:
  build:
    steps:
      - checkout

      - setup_remote_docker:
          version: 19.03.13
          docker_layer_caching: true

      # build and push Docker image
      - run: |
          docker build -t kubi .
          echo ${{secrets.DOCKER_PASSWORD}} | docker login -u ${{secrets.DOCKER_USERNAME}} --password-stdin
          docker tag kubi mihaiblandu/kubi
          docker push mihaiblandu/kubi
